\ProvidesPackage{beamerthemeawesome}[]


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\RequirePackage{kvoptions}
\SetupKeyvalOptions{family=awesome,prefix=awesome@}

\DeclareBoolOption{english}
\DeclareComplementaryOption{german}{english}

\DeclareBoolOption{notoc}
\DeclareBoolOption{secslide}
\DeclareBoolOption{subsecslide}
\DeclareBoolOption{nonumbersinframetitle}

\DeclareDefaultOption{\PassOptionsToPackage{\CurrentOption}{smile}}

\ProcessKeyvalOptions*

\ifawesome@english\RequirePackage[english]{babel}\else\RequirePackage[ngerman]{babel}\fi


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\RequirePackage{calc}
\RequirePackage{microtype}
\RequirePackage{etoolbox}
\RequirePackage{tcolorbox}
\tcbuselibrary{skins}
\RequirePackage{fontawesome5}
\RequirePackage[
	tikz,
	hyperref,
	pdftitle={\noexpand\inserttitle},
	pdfauthor={\noexpand\insertauthor},
	pdfsubject={\noexpand\inserttitle}
]{smile}

\usetikzlibrary{overlay-beamer-styles,decorations.markings}
\tikzset{
	node distance=5mm,
	invisible/.style={opacity=0},
	muted/.style={opacity=0.3},
	visible on/.style={alt={#1{}{invisible}}},
	hidden on/.style={alt={#1{invisible}{}}},
	muted on/.style={alt={#1{muted}{}}},
	unmuted on/.style={alt={#1{}{muted}}},
	alt/.code args={<#1>#2#3}{%
		\alt<#1>{\pgfkeysalso{#2}}{\pgfkeysalso{#3}}
	},
	modal background/.style={fill=gray,opacity=0.8},
	modal box/.style={draw=black,rnd,fill=white,lw,shadow,inner sep=3mm,text width=0.66\paperwidth},
	modal title/.style={roundednode,fill=black,text=white}
}

\newcommand{\mailicon}{%
											\csname tikz\endcsname[baseline=-0.55ex]{
		\draw[white,line width=0.45pt,rounded corners=0.4pt] (0,0) rectangle (0.22,0.14);
		\draw[white,line width=0.45pt] (0,0.14) -- (0.11,0.07) -- (0.22,0.14);
	}
}

\newcommand{\webicon}{%
											\csname tikz\endcsname[baseline=-0.55ex]{
		\draw[white,line width=0.45pt] (0.11,0.07) circle (0.07);
		\draw[white,line width=0.45pt] (0.04,0.07) -- (0.18,0.07);
		\draw[white,line width=0.45pt] (0.11,0.00) -- (0.11,0.14);
	}
}

\newcommand{\sparkleicon}{%
											\csname tikz\endcsname[baseline=-0.6ex]{
		\fill[white] (0,0.08) -- (0.03,0.03) -- (0.08,0) -- (0.03,-0.03) -- (0,-0.08) -- (-0.03,-0.03) -- (-0.08,0) -- (-0.03,0.03) -- cycle;
	}
}

\newcommand{\anticon}{%
											\csname tikz\endcsname[baseline=-0.55ex]{
		% Ant head
		\fill[white] (0.05,0.10) circle (0.025);
		% Ant thorax
		\fill[white] (0.05,0.05) circle (0.03);
		% Ant abdomen
		\fill[white] (0.05,-0.02) circle (0.035);
		% Ant legs left
		\draw[white,line width=0.4pt] (0.02,0.05) -- (-0.02,0.00);
		\draw[white,line width=0.4pt] (0.02,0.05) -- (-0.02,0.05);
		\draw[white,line width=0.4pt] (0.02,0.00) -- (-0.02,0.08);
		% Ant legs right
		\draw[white,line width=0.4pt] (0.08,0.05) -- (0.12,0.00);
		\draw[white,line width=0.4pt] (0.08,0.05) -- (0.12,0.05);
		\draw[white,line width=0.4pt] (0.08,0.00) -- (0.12,0.08);
		% Ant antennae
		\draw[white,line width=0.3pt] (0.06,0.12) -- (0.08,0.15);
		\draw[white,line width=0.3pt] (0.04,0.12) -- (0.02,0.15);
	}
}

% GitHub icon using FontAwesome
\newcommand{\githubicon}[1][accent]{%
	{\textcolor{#1}{\faGithub}}%
}

% LinkedIn icon using FontAwesome
\newcommand{\linkedinicon}[1][accent]{%
	{\textcolor{#1}{\faLinkedin}}%
}

% Website/Globe icon using FontAwesome
\newcommand{\websiteicon}[1][accent]{%
	{\textcolor{#1}{\faGlobe}}%
}

% YouTube icon using FontAwesome
\newcommand{\youtubeicon}[1][accent]{%
	{\textcolor{#1}{\faYoutube}}%
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\def\maketitle{
	\begin{frame}[noframenumbering,plain]
		\titlepage
	\end{frame}
	\ifawesome@notoc\else
		\begin{frame}{Agenda}
			\tableofcontents
		\end{frame}
	\fi
}

\let\oldft\frametitle
\renewcommand\frametitle[2][]{%
	\ifx\relax#1\relax\oldft{#2}\else%
		\ifnum\beamer@autobreakcount>0\oldft[#1]{#2}\else%
			\oldft{#2\hfill\normalfont\large\color{darkgray}\raisebox{0.3ex}{#1}}%
		\fi%
	\fi%
}

\providebool{wideframe}
\define@key{beamerframe}{wide}[true]{
	\booltrue{wideframe}
	\begingroup
}

\apptocmd{\beamer@reseteecodes}{%
	\ifbool{wideframe}{%
		\endgroup
		\boolfalse{wideframe}
	}{}
}{}{}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\newcounter{framesinsection}
\newcounter{framesinsubsection}
\counterwithin*{framesinsection}{section}
\counterwithin*{framesinsubsection}{subsection}

\def\stepframe{%
	\ifbeamer@isfragile%
		\stepcounter{framesinsection}%
		\stepcounter{framesinsubsection}%
	\else%
		\ifbeamer@noframenumbering\else%
			\stepcounter{framesinsection}%
			\stepcounter{framesinsubsection}%
		\fi%
	\fi%
	\ifnum\theframesinsection=0\setcounter{framesinsection}{1}\fi%
	\ifnum\theframesinsubsection=0\setcounter{framesinsubsection}{1}\fi%
}

\BeforeBeginEnvironment{frame}{\stepframe}
\pretocmd\againframe{\stepframe}{}{}

\def\refreshcountsinaux{%
	\immediate\write\@auxout{\global\noexpand\@namedef{s@totalsubsectionframes-\arabic{section}-\arabic{subsection}}{\theframesinsubsection}}%
	\immediate\write\@auxout{\global\noexpand\@namedef{s@totalsectionframes-\arabic{section}}{\theframesinsection}}%
}

\newcounter{secinc}
\pretocmd\section{%
	% At this point, the section command has not yet incremented the section counter, so we need to do this by ourselves
	\setcounter{secinc}{\thesection + 1}%
	\refreshcountsinaux%
	\immediate\write\@auxout{\global\noexpand\@namedef{s@frameatsecstart-\arabic{secinc}}{\insertframenumber}}%
}{}{}

\newcounter{subsecinc}
\pretocmd\subsection{%
	% At this point, the subsection command has not yet incremented the subsection counter, so we need to do this by ourselves
	\setcounter{subsecinc}{\thesubsection + 1}%
	\refreshcountsinaux%
	\immediate\write\@auxout{\global\noexpand\@namedef{s@frameatsubsecstart-\arabic{section}-\arabic{subsecinc}}{\insertframenumber}}%
}{}{}

\AtEndDocument{\refreshcountsinaux}

\def\framespersection{%
	\ifcsdef{s@totalsectionframes-\arabic{section}}{%
		\csname s@totalsectionframes-\arabic{section}\endcsname%
	}{0}%
}

\def\framespersubsection{%
	\ifcsdef{s@totalsubsectionframes-\arabic{section}-\arabic{subsection}}{%
		\csname s@totalsubsectionframes-\arabic{section}-\arabic{subsection}\endcsname%
	}{0}%
}

\def\insertsectionstartframe{%
	\ifcsdef{s@frameatsecstart-\arabic{section}}{%
		\csname s@frameatsecstart-\arabic{section}\endcsname%
	}{0}%
}

\def\insertsubsectionstartframe{%
	\ifcsdef{s@frameatsubsecstart-\arabic{section}-\arabic{subsection}}{%
		\csname s@frameatsubsecstart-\arabic{section}-\arabic{subsection}\endcsname%
	}{0}%
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\setbeamercolor{alerted text}{fg=accent}

\setbeamercolor{title}{fg=black}
\setbeamercolor{subtitle}{fg=darkgray}

\setbeamercolor{frametitle}{fg=black}
\setbeamercolor{framesubtitle}{fg=darkgray}

\setbeamercolor{details}{fg=black}
\setbeamercolor{author}{fg=black}

\setbeamercolor{section number projected}{bg=black, fg=accent}
\setbeamercolor{subsection number projected}{fg=lightgray, fg=accent}

\setbeamercolor{structure}{fg=black}
\setbeamercolor{normal text}{fg=black}
\setbeamercolor{separator}{fg=accent, bg=accent}
\setbeamercolor{footline}{bg=lightgray}
\setbeamercolor{footlineright}{fg=white, bg=accent}

\setbeamercolor{block body}{bg=lightgray}
\setbeamercolor{block title}{bg=black, fg=white}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\setbeamerfont{title}{size=\LARGE,shape=\bfseries\scshape}
\setbeamerfont{subtitle}{size=\large,shape=\normalfont}

\setbeamerfont{author}{size=\normalsize,shape=\normalfont}
\setbeamerfont{details}{size=\footnotesize,shape=\normalfont}

\setbeamerfont{footline}{size=\tiny,shape=\normalfont}

\setbeamerfont{footnote}{size=\tiny,shape=\normalfont}

\setbeamerfont{frametitle}{size=\LARGE,shape=\bfseries\scshape}

\setbeamerfont{framesubtitle}{size=\normalsize,shape=\normalfont}

\setbeamerfont{block title}{size=\normalfont,shape=\strut}
\setbeamerfont{blockdef}{size=\large,shape=\bfseries}

\setbeamerfont{description item}{shape=\bfseries}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\newlength\awesome@sidebarwidth\setlength{\awesome@sidebarwidth}{0.09\paperwidth}
\newlength\awesome@textmargin\setlength{\awesome@textmargin}{0.05\paperwidth}
\setbeamersize{description width=0.5cm}
\setbeamersize{sidebar width left=\awesome@sidebarwidth}
\setbeamersize{sidebar width right=0.02\paperwidth} % z.B. 2%
\setbeamersize{text margin left=\awesome@textmargin}
\setbeamersize{text margin right=\awesome@textmargin}

\setbeamertemplate{caption}{\insertcaption}
\setbeamertemplate{blocks}[rounded][shadow=false]
\setbeamertemplate{itemize item}[circle]
\setbeamertemplate{itemize subitem}[circle]

\addtobeamertemplate{frametitle continuation}{\color{gray}(}{)}
\setbeamertemplate{navigation symbols}{}
\setbeamertemplate{headline}{}

\setbeamertemplate{section in toc}{%
	\usebeamercolor[fg]{section number projected}\inserttocsectionnumber.%
	\usebeamercolor[fg]{normal text}~\inserttocsection%
}

\newenvironment{wide}{\begingroup\leavevmode%
	\hspace*{-\awesome@sidebarwidth}\fboxsep\z@\minipage{\linewidth+2cm}%
}{\endminipage\endgroup}

\setbeamertemplate{subsection in toc}{%
	\mbox{\hskip2em%
		\usebeamercolor[fg]{section number projected}\inserttocsectionnumber.%
		\usebeamercolor[fg]{subsection number projected}\textsubscript{\inserttocsubsectionnumber}%
		\usebeamercolor[fg]{normal text}~\inserttocsubsection%
	}%
}

\setbeamertemplate{separator}{%
	\usebeamercolor{separator}\textcolor{fg}{\rule{.7\textwidth}{\smile@linewidth}}%
}

\setbeamertemplate{frametitle}{%
	\vspace{1em}\ifawesome@nonumbersinframetitle\ifbool{wideframe}{\hspace{-\awesome@sidebarwidth}}{}\else\hspace{-\awesome@sidebarwidth}\begin{beamercolorbox}[wd=\awesome@sidebarwidth,right]{frametitle}%
		\usebeamerfont{frametitle}%
		\ifx\insertsection\empty\else%
			{\color{accent}\scalebox{1.1}{\thesection}}%
			\ifx\insertsubsection\empty%
				\ifnum\framespersection>1%
					.\color{black!25!white}\scalebox{.7}{\theframesinsection}%
				\fi%
			\else%
				.\thesubsection%
				\ifnum\framespersubsection>1%
					.\color{black!25!white}\scalebox{.7}{\theframesinsubsection}%
				\fi%
			\fi%
		\fi
	\end{beamercolorbox}\fi%
	\ifawesome@nonumbersinframetitle%
		\begin{beamercolorbox}{frametitle}%
	\else%
		\begin{beamercolorbox}[leftskip=1.2em]{frametitle}%
	\fi%
		\insertframetitle%
	\end{beamercolorbox}
	\ifx\usebeamercolor{subtitle}\insertframesubtitle\empty\else%
	\begin{beamercolorbox}{framesubtitle}%
		\ifawesome@nonumbersinframetitle\ifbool{wideframe}{\hspace{-\awesome@sidebarwidth}}{}\fi\usebeamerfont{subtitle}\insertframesubtitle%
	\end{beamercolorbox}\fi%
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newtcolorbox{beamerbox}[3][]{boxrule=\smile@linewidth,
IfBlankTF={#3}{toprule=2mm}{title=#3},colback=#2!5!white,colframe=#2!75!black,left=0.8em,
lefttitle=4mm, arc=\smile@rounding, enhanced, segmentation engine=path,
segmentation style={lcr, solid, shorten >=1mm,shorten <=1mm, line width=\smile@linewidth},#1}

\renewenvironment{definition}[1][\empty]{%
	\begin{beamerbox}{gray}{#1}%
}{\end{beamerbox}}

\renewenvironment{block}[1][]{%
	\begin{beamerbox}{accent}{#1}%
}{\end{beamerbox}}

\renewenvironment{examples}[1][]{%
	\begin{beamerbox}{green}{#1}%
}{\end{beamerbox}}

\renewenvironment{alertblock}[1][]{%
	\begin{beamerbox}{red}{#1}%
}{\end{beamerbox}}

\newenvironment<>{modal}[1][]{%
	\def\titlename{#1}%
	\visibleenv#2%
	\begin{tikzpicture}[o,node distance=0pt]%
		\fill[modal background] (current page.south west) rectangle (current page.north east);%
		\node[modal box] at (current page) (MODALCONTENT) \bgroup%
}{%
		\egroup;%
		\if\expandafter\isempty\expandafter{\titlename}\else\node[modal title] at (MODALCONTENT.north) {\titlename};\fi
	\end{tikzpicture}%
	\endvisibleenv%
}

\ensureinfocommand{title}
\ensureinfocommand{author}
\ensureinfocommand{background}
\ensureinfocommand{email}
\ensureinfocommand{uni}
\ensureinfocommand{location}
\ensureinfocommand{social}
\def\inserttitle{\ifdefined\@title\@title\fi}
\def\insertshorttitle{\ifdefined\@shorttitle\@shorttitle\fi}
\def\insertauthor{\ifdefined\@author\@author\fi}
\def\insertshortauthor{\ifdefined\@shortauthor\@shortauthor\fi}
\def\insertemail{\ifdefined\@email\href{mailto:\@email}{\@email}\fi}
\def\insertuni{\ifdefined\@uni\@uni\fi}
\def\insertlocation{\ifdefined\@location\@location\fi}
\def\insertsocial{\ifdefined\@social\@social\fi}

\newcommand{\socialbadge}[1]{%
											\csname tikz\endcsname[baseline=-0.6ex]{%
		\node[draw=accent,rounded corners=0.4mm,inner xsep=0.6mm,inner ysep=0.2mm,text=accent,font=\scriptsize\sffamily] {#1};%
	}%
}

\newcommand{\socialbadgeinverse}[1]{%
											\csname tikz\endcsname[baseline=-0.6ex]{%
		\node[draw=white,rounded corners=0.4mm,inner xsep=0.6mm,inner ysep=0.2mm,text=white,font=\scriptsize\sffamily] {#1};%
	}%
}

% Helper to select icon based on type
\newcommand{\selectsocialicon}[2]{%
	\ifstrequal{#1}{GH}{%
		\githubicon[#2]%
	}{%
		\ifstrequal{#1}{in}{%
			\linkedinicon[#2]%
		}{%
			\ifstrequal{#1}{www}{%
				\websiteicon[#2]%
			}{%
				\ifstrequal{#1}{YT}{%
					\youtubeicon[#2]%
				}{%
					\socialbadge{#1}%
				}%
			}%
		}%
	}%
}

\newcommand{\selectsocialiconinverse}[2]{%
	\ifstrequal{#1}{GH}{%
		\githubicon[white]%
	}{%
		\ifstrequal{#1}{in}{%
			\linkedinicon[white]%
		}{%
			\ifstrequal{#1}{www}{%
				\websiteicon[white]%
			}{%
				\ifstrequal{#1}{YT}{%
					\youtubeicon[white]%
				}{%
					\socialbadgeinverse{#1}%
				}%
			}%
		}%
	}%
}

% Usage: \social{\socialitem{GH}{kataglyphis}{https://github.com/kataglyphis} \hspace{1em} ...}
\newcommand{\socialitem}[3]{\selectsocialicon{#1}{accent}\hspace{0.4em}\href{#3}{#2}}
\newcommand{\socialiteminverse}[3]{\selectsocialiconinverse{#1}{white}\hspace{0.4em}\href{#3}{#2}}

\tikzfading[
	name=title page picture fading,
	left color=transparent!0,
	right color=transparent!100,
]

\def\ps@navigation@titlepage{\setbeamertemplate{footline}{}\@nameuse{ps@navigation}}

\newlength\lhswidth\setlength{\lhswidth}{.55\textwidth}
\newlength\titlewidth
\newlength\subtitlewidth
\newlength\maxwidth
\setbeamertemplate{title page}{\begin{wide}
	\def\titlecontent{\usebeamerfont{title}\usebeamercolor[fg]{title}\inserttitle}%
	\def\subtitlecontent{\usebeamerfont{subtitle}\usebeamercolor[fg]{subtitle}\insertsubtitle}%
	\settowidth\titlewidth\titlecontent%
	\settowidth\subtitlewidth\subtitlecontent%
	\setlength\maxwidth{\ifdim\titlewidth>\subtitlewidth\titlewidth\else\subtitlewidth\fi}%
	\thispagestyle{navigation@titlepage}%
	\begin{minipage}{\lhswidth}
		\raggedright%
		\titlecontent\\
		\subtitlecontent\\
		\textcolor{accent}{\rule{\ifdim\maxwidth<\lhswidth\maxwidth\else\lhswidth\fi}{\smile@linewidth}}\\[2em]
		\usebeamerfont{author}\usebeamercolor[fg]{author}%
		\insertauthor\\
		\usebeamerfont{details}\usebeamercolor[fg]{details}%
		\insertemail\par
		\ifdefined\@social
			\insertsocial\par
		\fi
		\vspace{2em}
		\usebeamerfont{details}\usebeamercolor[fg]{details}%
		\insertinstitute\\
		\insertuni\\[2em]
		\insertdate
	\end{minipage}

	\ifdefined\@background
		\begin{tikzpicture}[o]
			\clip (current page.south east)
				-- (current page.north east)
				-- ++(-5.1, 0)
				-- ++(-3, -\paperheight)
				-- cycle;

			\node[anchor=south east,inner sep=0,outer sep=0] at (current page.south east) {
				\includegraphics[height=\paperheight]{\@background}
			};

			\fill[black,path fading=title page picture fading,fading angle=-15]
				(current page.south east) rectangle ++(-10, \dimexpr\paperheight+1cm);
		\end{tikzpicture}
		\tikz[o]\draw[black,lcr,line width=2*\smile@linewidth]
			([shift={(-5.1,0)}]current page.north east)
			-- ++(-3,-\paperheight);
	\fi
\end{wide}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newlength\maxfooterwd\maxfooterwd=0pt
\def\updatemaxfooterwd#1{\ifdim#1>\maxfooterwd%
	\global\maxfooterwd=#1%
	\immediate\write\@auxout{\global\maxfooterwd=\the#1}%
\fi}
% Make sure we always put the current max footer width into the aux file
\AtEndDocument{\immediate\write\@auxout{\global\maxfooterwd=\the\maxfooterwd}}
\newsavebox\footerright
\def\setfooter#1#2#3{\savebox\footerright{\color{white}\hspace{0.3cm}#3\hspace{0.3cm}}
	\updatemaxfooterwd{\wd\footerright}\leavevmode\hbox{%
	\usebeamerfont{footline}%
	\begin{beamercolorbox}[wd=\dimexpr\textwidth-\maxfooterwd\relax,ht=2.5ex,dp=1ex]{footline}%
		\hspace{0.3cm}#1\hfill#2\hfill\null%
	\end{beamercolorbox}%
	\begin{beamercolorbox}[wd=\maxfooterwd,ht=2.5ex,dp=1ex]{footlineright}%
		\centerline{\usebox\footerright}%
	\end{beamercolorbox}%
}}

\def\awesome@smalldot{\tikz[baseline=-.6ex]\node[circle,inner sep=0.16,draw=.,fill=.]{};}
\def\awesome@fulldot{\tikz[baseline=-.6ex]\node[circle,inner sep=0.32ex,draw=.,fill=.]{};}
\def\awesome@emptydot{\tikz[baseline=-.6ex]\node[circle,inner sep=0.32ex,draw=.,fill=none]{};}

\newcounter{pagenumbertolinkto}
\setbeamertemplate{footline}{%
	\setfooter{\insertshortauthor}{%
		\hyperlinkdocumentstart{\insertshorttitle}\hspace{.7em}\awesome@smalldot\hspace{.7em}\insertsection%
		\ifx\insertsubsection\empty%
			\hspace{.4em}%
			\ifnum\framespersection>1%
				\foreach \i in {1, ..., \framespersection}{%
					\ifnum \i=\theframesinsection%
						~\awesome@fulldot%
					\else%
						\setcounter{pagenumbertolinkto}{\i + \insertsectionstartframe}%
						~\hyperlink{page:\thepagenumbertolinkto}{\awesome@emptydot}%
					\fi%
				}%
			\fi%
		\else%
			\hspace{.7em}\awesome@smalldot\hspace{.7em}\insertsubsection%
			\hspace{.7em}%
			\ifnum\framespersubsection>1%
				\foreach \i in {1, ..., \framespersubsection}{%
					\ifnum \i=\theframesinsubsection%
						~\awesome@fulldot%
					\else%
						\setcounter{pagenumbertolinkto}{\i + \insertsubsectionstartframe}%
						~\hyperlink{page:\thepagenumbertolinkto}{\awesome@emptydot}%
					\fi%
				}%
			\fi%
		\fi%
	}{\ifawesome@english Page\else Seite\fi~\insertframenumber~/~\inserttotalframenumber}%
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\def\ps@navigation@toc{%
	\setbeamertemplate{footline}{\setfooter{\insertshortauthor}{\hyperlinkdocumentstart{\insertshorttitle}}{Agenda}}%
	\@nameuse{ps@navigation}%
}

\def\ps@navigation@sec{%
	\setbeamertemplate{footline}{%
		\setfooter{\insertshortauthor}%
		{\hyperlinkdocumentstart{\insertshorttitle}}%
		{\ifawesome@english Section\else Kapitel\fi~\thesection\ifx\insertsubsection\empty\else.\thesubsection\fi}%
	}%
	\@nameuse{ps@navigation}%
}

\pretocmd\tableofcontents{\thispagestyle{navigation@toc}}{}{}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


% Kinda hacky, but AtBeginEnvironment does not work with beamer tex.stackexchange.com/a/436338/286979
\pretocmd\beamer@checkframetitle{%
	\transfade[duration=0.1]%
	\ifbeamer@isfragile%
		\label{page:\insertframenumber}%
	\else\ifbeamer@noframenumbering\else\hypertarget{page:\insertframenumber}{}\fi\fi%
}


\AtBeginSection[]{\ifawesome@secslide
	\begin{frame}[c,noframenumbering]\thispagestyle{navigation@sec}%
		\begin{wide}\centering%
		\usebeamerfont{title}%
		\usebeamercolor[fg]{section number projected}%
		\scalebox{1.3}{ \raisebox{-1pt}{\insertsectionnumber}}.~%
		\usebeamercolor[fg]{title}%
		\insertsectionhead%
		\end{wide}%
	\end{frame}
\fi}

\AtBeginSubsection[]{\ifawesome@subsecslide
	\begin{frame}[c,noframenumbering]\thispagestyle{navigation@sec}%
		\begin{wide}\centering%
		\usebeamerfont{title}%
		\usebeamercolor[fg]{section number projected}%
		\scalebox{1.3}{\raisebox{-1pt}{\insertsectionnumber}}.%
		\usebeamercolor[fg]{subsection number projected}%
		\textsubscript{\insertsubsectionnumber}~%
		\usebeamercolor[fg]{title}%
		\insertsubsectionhead%
		\end{wide}%
	\end{frame}
\fi}

\AtEndDocument{
	{\setbeamercolor{background canvas}{bg=accent}
	\begin{frame}[c,noframenumbering]\thispagestyle{navigation@titlepage}%
		\begin{wide}\color{white}%
			\hypersetup{urlcolor=white,linkcolor=white,citecolor=white}
			% Epic desert landscape with sand dunes
			\begin{tikzpicture}[remember picture,overlay]
				% Sand dune layers - wavy pattern
				\fill[white,opacity=0.06] (current page.south west) -- ([yshift=1.5cm]current page.south west) 
					.. controls ([yshift=2cm,xshift=3cm]current page.south west) .. ([yshift=2.5cm,xshift=6cm]current page.south west)
					.. controls ([yshift=3cm,xshift=9cm]current page.south west) .. ([yshift=2cm,xshift=12cm]current page.south west)
					.. controls ([yshift=1cm,xshift=15cm]current page.south west) .. (current page.south east)
					-- ([yshift=0cm]current page.south east) -- cycle;
				\fill[white,opacity=0.04] (current page.south west) -- ([yshift=3cm]current page.south west)
					.. controls ([yshift=4cm,xshift=4cm]current page.south west) .. ([yshift=4.5cm,xshift=8cm]current page.south west)
					.. controls ([yshift=5cm,xshift=12cm]current page.south west) .. ([yshift=3.5cm,xshift=16cm]current page.south west)
					.. controls ([yshift=2.5cm,xshift=20cm]current page.south west) .. (current page.south east)
					-- ([yshift=2cm]current page.south east) -- cycle;
				% Desert heat shimmer lines
				\draw[white,opacity=0.10,line width=0.8pt] ([yshift=2cm]current page.south west) 
					.. controls ([yshift=2.3cm,xshift=3cm]current page.south west) .. ([yshift=1.8cm,xshift=6cm]current page.south west);
				\draw[white,opacity=0.08,line width=0.6pt] ([yshift=4.5cm]current page.south west)
					.. controls ([yshift=4.8cm,xshift=3cm]current page.south west) .. ([yshift=4.2cm,xshift=6cm]current page.south west);
				% Ant trails scattered across desert
				\foreach \x in {1,3,5,7,9,11,13,15} {
					\draw[white,opacity=0.12,line width=0.3pt] ([xshift=\x cm,yshift=1cm]current page.south west) -- ([xshift=\x cm,yshift=0.3cm]current page.south west);
				}
				% Distant dunes (very faint)
				\fill[white,opacity=0.02] (current page.north west) 
					.. controls ([yshift=-1cm,xshift=4cm]current page.north west) .. ([yshift=-2cm,xshift=8cm]current page.north west)
					.. controls ([yshift=-3cm,xshift=12cm]current page.north west) .. (current page.north east)
					-- ([yshift=0cm]current page.north east) -- cycle;
			\end{tikzpicture}
			\begin{columns}[c,totalwidth=\linewidth]
				\column{0.38\linewidth}
				\centering
				% Decorative top left corner
				\begin{tikzpicture}[remember picture, overlay]
					\begin{scope}[shift={(current page.north west)},shift={(0.5cm,-0.5cm)}]
						% Corner ornament
						\foreach \i in {1,2,3} {
							\draw[white,opacity=0.35,line width=0.4pt] (0,0) -- (\i*0.3cm,0);
							\draw[white,opacity=0.35,line width=0.4pt] (0,0) -- (0,-\i*0.3cm);
						}
						\node[white,font=\tiny,opacity=0.4] at (0.5cm,-0.5cm) {\anticon};
					\end{scope}
				\end{tikzpicture}
				% Epic image styling with sand glow (desert heat effect)
				\begin{tikzpicture}
					% Sand glow layers (warm desert effect)
					\fill[white,opacity=0.12] (0,0) circle (2.55cm);
					\fill[white,opacity=0.18] (0,0) circle (2.40cm);
					\fill[white,opacity=0.10] (0,0) circle (2.70cm);
					% Desert sand rings
					\draw[white,line width=2.5pt,opacity=0.35] (0,0) circle (2.30cm);
					\draw[white,line width=1.2pt,opacity=0.45] (0,0) circle (2.20cm);
					% Main image with clip
					\clip (0,0) circle (2.10cm);
					\node at (0,0) {\includegraphics[width=4.8cm,height=4.8cm,keepaspectratio]{/md2pdfLib/presentation/images/579706fe.jpg}};
					\draw[white,line width=2pt] (0,0) circle (2.10cm);
				\end{tikzpicture}
				% Marching ant army - Cataglyphis tangential navigation style with enhancements
				\begin{tikzpicture}[remember picture, overlay, shift={(current page.center)}]
				\begin{scope}[shift={(-4.25cm,0.5cm)}]
						% Concentric spiral paths - path integration concept
						\foreach \radius in {1.8, 2.0, 2.2, 2.4} {
							\draw[white,opacity=0.15,line width=0.3pt] (0,0) circle (\radius cm);
						}
						% Compass directional indicators (corrected: N is at top, E is at right)
						\foreach \angle/\label in {90/N, 0/E, 270/S, 180/W} {
							\node[white,font=\tiny,opacity=0.5] at (\angle:3.15cm) {\label};
							\draw[white,opacity=0.4,line width=0.5pt] (\angle:3.05cm) -- (\angle:3.10cm);
						}
						% Tangential spiral paths showing Cataglyphis navigation
						\foreach \angle in {0,30,60,90,120,150,180,210,240,270,300,330} {
							% Multiple curved layers for depth
							\draw[white,opacity=0.35,line width=1.2pt] 
								(\angle:2.30cm) .. controls (\angle:2.50cm) and (\angle:2.75cm) .. (\angle:3.00cm);
							\draw[white,opacity=0.55,line width=0.8pt] 
								(\angle:2.30cm) .. controls (\angle:2.50cm) and (\angle:2.75cm) .. (\angle:3.00cm);
							% Ant symbols at regular intervals
							\node[white,font=\large] at (\angle:2.90cm) {\anticon};
							% Directional indicators - small lines showing ant orientation
							\draw[white,opacity=0.40,line width=0.3pt] (\angle:2.85cm) -- (\angle:2.95cm);
						}
						% Central reference circle (faint)
						\draw[white,opacity=0.25,line width=0.5pt] (0,0) circle (2.30cm);
						% Center dot for path integration start
						\fill[white,opacity=0.50] (0,0) circle (0.08cm);
					\end{scope}
				\end{tikzpicture}
				% Decorative bottom left corner
				\begin{tikzpicture}[remember picture, overlay]
					\begin{scope}[shift={(current page.south west)},shift={(0.5cm,0.5cm)}]
						% Corner ornament
						\foreach \i in {1,2,3} {
							\draw[white,opacity=0.35,line width=0.4pt] (0,0) -- (\i*0.3cm,0);
							\draw[white,opacity=0.35,line width=0.4pt] (0,0) -- (0,\i*0.3cm);
						}
						\node[white,font=\tiny,opacity=0.3] at (0.5cm,0.5cm) {\anticon};
					\end{scope}
				\end{tikzpicture}
				\column{0.62\linewidth}
				% Visual connection lines from image to text
				\begin{tikzpicture}[remember picture, overlay]
					\begin{scope}[shift={(current page.center)},shift={(0.8cm,0cm)}]
						% Subtle connecting curves
						\draw[white,opacity=0.15,line width=0.6pt] (-2.2cm,1.2cm) .. controls (-1.5cm,1.0cm) .. (-0.8cm,0.8cm);
						\draw[white,opacity=0.15,line width=0.6pt] (-2.2cm,-1.2cm) .. controls (-1.5cm,-1.0cm) .. (-0.8cm,-0.8cm);
					\end{scope}
				\end{tikzpicture}
				% Epic title with enhanced desert styling
				\begin{tikzpicture}[baseline=(title.base)]
					% Title shadow effect
					\node[inner sep=0,color=white,opacity=0.20] at (0.05,-0.05) {{\Huge\textbf{Keep in contact}}};
					\node[inner sep=0] (title) {{\Huge\textbf{Keep in contact}}};
					% Enhanced decorative underline with multiple layers
					\draw[white,line width=1.2pt,opacity=0.7] ([xshift=-0.5cm]title.south west) -- ([xshift=0.5cm]title.south east);
					\draw[white,line width=0.6pt,opacity=0.5] ([xshift=-0.45cm,yshift=-0.12cm]title.south west) -- ([xshift=0.45cm,yshift=-0.12cm]title.south east);
					\draw[white,line width=0.3pt,opacity=0.35] ([xshift=-0.4cm,yshift=-0.20cm]title.south west) -- ([xshift=0.4cm,yshift=-0.20cm]title.south east);
					% Side accent lines
					\draw[white,line width=1.5pt,opacity=0.4] ([xshift=-0.65cm,yshift=-0.05cm]title.north west) -- ([xshift=-0.65cm,yshift=-0.25cm]title.south west);
					\draw[white,line width=1.5pt,opacity=0.4] ([xshift=0.65cm,yshift=-0.05cm]title.north east) -- ([xshift=0.65cm,yshift=-0.25cm]title.south east);
				\end{tikzpicture}\\[0.2em]
				% Enhanced desert horizon divider
				\begin{tikzpicture}
					\shade[left color=white!30,middle color=white,right color=white!10] (0,0) rectangle (0.62\linewidth,0.06cm);
					\draw[white,opacity=0.5,line width=0.3pt] (0,0) -- (0.62\linewidth,0);
				\end{tikzpicture}\\[0.3em]
				% Name with enhanced styling
				{{\LARGE\textbf{\insertauthor}}}\\[0.2em]
				% Tagline with improved spacing
				{\small\textsc{%
					\anticon\ \textbf{Navigate}\ $\bullet$\ \textbf{Optimize}\ $\bullet$\ \textbf{Collaborate}\ $\bullet$\ \textbf{Innovate}\ \anticon%
				}}\\[0.4em]
				% Info section with enhanced styling
				\begin{tikzpicture}
					% Background layers for depth
					\fill[white,opacity=0.08] (-0.3,-0.35) rectangle (0.3,0.35) (0,0) circle (0.40cm);
					\node[inner sep=6pt,rounded corners=5pt,fill=black,fill opacity=0.32,draw=white,line width=0.8pt,draw opacity=0.55] (info) {%
						\begin{minipage}{0.56\linewidth}
							\centering
							{\scriptsize\bfseries\insertinstitute}\\[0.08em]
							{\tiny\insertuni}\\[0.25em]
							{\scriptsize\insertlocation\ \textbullet\ \insertdate}\\[0.18em]
							{\scriptsize\mailicon\ \insertemail}
						\end{minipage}
					};
					% Enhanced decorative corners - all four corners
					\draw[white,opacity=0.3,line width=0.5pt] ([xshift=-0.35cm,yshift=0.35cm]info.north west) -- ([xshift=-0.10cm,yshift=0.35cm]info.north west);
					\draw[white,opacity=0.3,line width=0.5pt] ([xshift=-0.35cm,yshift=0.35cm]info.north west) -- ([xshift=-0.35cm,yshift=0.15cm]info.north west);
					\draw[white,opacity=0.3,line width=0.5pt] ([xshift=0.35cm,yshift=0.35cm]info.north east) -- ([xshift=0.10cm,yshift=0.35cm]info.north east);
					\draw[white,opacity=0.3,line width=0.5pt] ([xshift=0.35cm,yshift=0.35cm]info.north east) -- ([xshift=0.35cm,yshift=0.15cm]info.north east);
					\draw[white,opacity=0.25,line width=0.5pt] ([xshift=-0.35cm,yshift=-0.35cm]info.south west) -- ([xshift=-0.10cm,yshift=-0.35cm]info.south west);
					\draw[white,opacity=0.25,line width=0.5pt] ([xshift=-0.35cm,yshift=-0.35cm]info.south west) -- ([xshift=-0.35cm,yshift=-0.15cm]info.south west);
				\end{tikzpicture}\\[0.25em]
				% Website link with enhanced styling
				% Decorative top right corner
				\begin{tikzpicture}[remember picture, overlay]
					\begin{scope}[shift={(current page.north east)},shift={(-0.5cm,-0.5cm)}]
						% Corner ornament
						\foreach \i in {1,2,3} {
							\draw[white,opacity=0.35,line width=0.4pt] (0,0) -- (-\i*0.3cm,0);
							\draw[white,opacity=0.35,line width=0.4pt] (0,0) -- (0,-\i*0.3cm);
						}
						\node[white,font=\tiny,opacity=0.4] at (-0.5cm,-0.5cm) {\anticon};
					\end{scope}
				\end{tikzpicture}
				% Social links section with enhanced styling
				\ifdefined\@social%
					{\small%
					\begingroup
					\let\socialbadge\socialbadgeinverse%
					\let\socialitem\socialiteminverse%
					\begin{tabular}{ll}
						\insertsocial & \\[0.3em]
						\socialiteminverse{YT}{YouTube}{https://www.youtube.com/@jotrockenmitlocken} & 
					\end{tabular}
					\endgroup
					}%
				\fi
			\end{columns}
		\end{wide}%
	\end{frame}}
}